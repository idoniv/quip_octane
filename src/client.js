const OCTANE_BASE_URI = "https://mqast001pngx.saas.hpe.com/";
const OCTANE_DEFECTS_URI = OCTANE_BASE_URI + "api/shared_spaces/222009/workspaces/1002/defects?limit=5";

const DEFECTS_MOCK = '{"total_count":294,"data":[{"type":"defect","creation_time":"2018-01-15T13:37:20Z","parent":{"type":"work_item","subtype":"work_item_root","name":"Backlog","id":"1001"},"logical_name":"p2459qvdg2o0tqo04n5d8knve","defect_root_level":null,"version_stamp":2,"release":null,"sprint":null,"description":null,"detected_in_release":null,"fixed_in_build":null,"workspace_id":1002,"path":"0000000001PS","item_origin":null,"blocked":false,"qa_owner":null,"detected_by":null,"invested_hours":0,"is_draft":false,"closed_on":null,"id":"2034","last_modified":"2018-01-15T13:37:20Z","defect_type":null,"owner":null,"phase":{"type":"phase","activity_level":0,"logical_name":"phase.defect.fixed","name":"Fixed","index":10700,"id":"phase.defect.fixed"},"severity":{"type":"list_node","workspace_id":1002,"activity_level":0,"logical_name":"list_node.severity.high","name":"High","index":3,"id":"list_node.severity.high"},"fixed_on":null,"author":{"type":"workspace_user","activity_level":0,"full_name":"Michal Yakove","name":"michalc@hpe.com","id":"2001"},"story_points":null,"product_areas":{"total_count":0,"data":[]},"team":null,"priority":null,"remaining_hours":0,"user_tags":{"total_count":0,"data":[]},"milestone":null,"taxonomies":{"total_count":0,"data":[]},"blocked_reason":null,"name":"[MC] production coverage widget: when interval between from and to is too small","estimated_hours":0,"original_id":null,"detected_in_build":null},{"type":"defect","creation_time":"2018-01-14T14:25:54Z","parent":{"type":"work_item","subtype":"work_item_root","name":"Backlog","id":"1001"},"logical_name":"do80lyedqm7gxhj4v1m8036vp","defect_root_level":null,"version_stamp":2,"release":null,"sprint":null,"description":null,"detected_in_release":null,"fixed_in_build":null,"workspace_id":1002,"path":"0000000002L7","item_origin":null,"blocked":false,"qa_owner":null,"detected_by":null,"invested_hours":0,"is_draft":false,"closed_on":null,"id":"3033","last_modified":"2018-01-14T14:25:54Z","defect_type":null,"owner":null,"phase":{"type":"phase","activity_level":0,"logical_name":"phase.defect.fixed","name":"Fixed","index":10700,"id":"phase.defect.fixed"},"severity":{"type":"list_node","workspace_id":1002,"activity_level":0,"logical_name":"list_node.severity.high","name":"High","index":3,"id":"list_node.severity.high"},"fixed_on":null,"author":{"type":"workspace_user","activity_level":0,"full_name":"Michal Yakove","name":"michalc@hpe.com","id":"2001"},"story_points":null,"product_areas":{"total_count":0,"data":[]},"team":null,"priority":null,"remaining_hours":0,"user_tags":{"total_count":0,"data":[]},"milestone":null,"taxonomies":{"total_count":0,"data":[]},"blocked_reason":null,"name":"[MC] production coverage widget: when interval between from and to is too small","estimated_hours":0,"original_id":null,"detected_in_build":null},{"type":"defect","creation_time":"2018-01-15T12:57:43Z","parent":{"type":"work_item","subtype":"work_item_root","name":"Backlog","id":"1001"},"logical_name":"g0z2w28y6von8ser2nz2dwnk6","defect_root_level":null,"version_stamp":2,"release":null,"sprint":null,"description":null,"detected_in_release":null,"fixed_in_build":null,"workspace_id":1002,"path":"0000000002ME","item_origin":null,"blocked":false,"qa_owner":null,"detected_by":null,"invested_hours":0,"is_draft":false,"closed_on":null,"id":"3074","last_modified":"2018-01-15T12:57:43Z","defect_type":null,"owner":null,"phase":{"type":"phase","activity_level":0,"logical_name":"phase.defect.fixed","name":"Fixed","index":10700,"id":"phase.defect.fixed"},"severity":{"type":"list_node","workspace_id":1002,"activity_level":0,"logical_name":"list_node.severity.high","name":"High","index":3,"id":"list_node.severity.high"},"fixed_on":null,"author":{"type":"workspace_user","activity_level":0,"full_name":"Michal Yakove","name":"michalc@hpe.com","id":"2001"},"story_points":null,"product_areas":{"total_count":0,"data":[]},"team":null,"priority":null,"remaining_hours":0,"user_tags":{"total_count":0,"data":[]},"milestone":null,"taxonomies":{"total_count":0,"data":[]},"blocked_reason":null,"name":"[MC] production coverage widget: when interval between from and to is too small","estimated_hours":0,"original_id":null,"detected_in_build":null},{"type":"defect","creation_time":"2018-01-15T13:36:42Z","parent":{"type":"work_item","subtype":"work_item_root","name":"Backlog","id":"1001"},"logical_name":"xg367d5mpw36psp4042ke8p0k","defect_root_level":null,"version_stamp":2,"release":null,"sprint":null,"description":null,"detected_in_release":null,"fixed_in_build":null,"workspace_id":1002,"path":"0000000001P3","item_origin":null,"blocked":false,"qa_owner":null,"detected_by":null,"invested_hours":0,"is_draft":false,"closed_on":null,"id":"2009","last_modified":"2018-01-15T13:36:42Z","defect_type":null,"owner":null,"phase":{"type":"phase","activity_level":0,"logical_name":"phase.defect.fixed","name":"Fixed","index":10700,"id":"phase.defect.fixed"},"severity":{"type":"list_node","workspace_id":1002,"activity_level":0,"logical_name":"list_node.severity.medium","name":"Medium","index":2,"id":"list_node.severity.medium"},"fixed_on":null,"author":{"type":"workspace_user","activity_level":0,"full_name":"Michal Yakove","name":"michalc@hpe.com","id":"2001"},"story_points":null,"product_areas":{"total_count":0,"data":[]},"team":null,"priority":null,"remaining_hours":0,"user_tags":{"total_count":0,"data":[]},"milestone":null,"taxonomies":{"total_count":0,"data":[]},"blocked_reason":null,"name":"[Regression Day] [Dashboard] [IE] Label in Mastercard graph is seen on top of drill down dialog","estimated_hours":0,"original_id":null,"detected_in_build":null},{"type":"defect","creation_time":"2018-01-15T13:36:45Z","parent":{"type":"work_item","subtype":"work_item_root","name":"Backlog","id":"1001"},"logical_name":"mwzr9klrz234nazkn5r0e7dn6","defect_root_level":null,"version_stamp":2,"release":null,"sprint":null,"description":null,"detected_in_release":null,"fixed_in_build":null,"workspace_id":1002,"path":"0000000001P6","item_origin":null,"blocked":false,"qa_owner":null,"detected_by":null,"invested_hours":0,"is_draft":false,"closed_on":null,"id":"2012","last_modified":"2018-01-15T13:36:45Z","defect_type":null,"owner":null,"phase":{"type":"phase","activity_level":0,"logical_name":"phase.defect.fixed","name":"Fixed","index":10700,"id":"phase.defect.fixed"},"severity":{"type":"list_node","workspace_id":1002,"activity_level":0,"logical_name":"list_node.severity.high","name":"High","index":3,"id":"list_node.severity.high"},"fixed_on":null,"author":{"type":"workspace_user","activity_level":0,"full_name":"Michal Yakove","name":"michalc@hpe.com","id":"2001"},"story_points":null,"product_areas":{"total_count":0,"data":[]},"team":null,"priority":null,"remaining_hours":0,"user_tags":{"total_count":0,"data":[]},"milestone":null,"taxonomies":{"total_count":0,"data":[]},"blocked_reason":null,"name":"[Regression Day] [Dashboard] [IE] Label in Mastercard graph is seen on top of drill down dialog","estimated_hours":0,"original_id":null,"detected_in_build":null}],"exceeds_total_count":false}';

export class OctaneClient {

	fetchDefects() {
		fetch(OCTANE_DEFECTS_URI, {
			method : 'GET',
			headers : {
				"Accept" : "application/json",
			},
			mode : 'cors',
			credentials : 'include',
		}).then(response => {
			console.log("Response: " + response.status);

			// return response.json(); // Gives Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://mqast001pngx.saas.hpe.com/api/shared_spaces/222009/workspaces/1002/defects. (Reason: CORS header ‘Access-Control-Allow-Origin’ missing).
			
			// TODO Remove mock once CORS trouble is resolved. 
			return new Promise((resolve, reject) => {
				resolve(JSON.parse(DEFECTS_MOCK));
			});
		}).then(json => {
			return json;
		}).catch(function(ex) {
			console.error('Parsing failed', ex);
		});
	}
}